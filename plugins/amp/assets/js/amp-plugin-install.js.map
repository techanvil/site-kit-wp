{"version":3,"file":"amp-plugin-install.js","mappings":"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","sources":["webpack://amp-wp/external var \"ampPlugins\"","webpack://amp-wp/external window \"lodash\"","webpack://amp-wp/external window [\"wp\",\"domReady\"]","webpack://amp-wp/external window [\"wp\",\"i18n\"]","webpack://amp-wp/webpack/bootstrap","webpack://amp-wp/webpack/runtime/compat get default export","webpack://amp-wp/webpack/runtime/define property getters","webpack://amp-wp/webpack/runtime/hasOwnProperty shorthand","webpack://amp-wp/webpack/runtime/make namespace object","webpack://amp-wp/./assets/src/admin/amp-plugin-install.js"],"sourcesContent":["module.exports = ampPlugins;","module.exports = window[\"lodash\"];","module.exports = window[\"wp\"][\"domReady\"];","module.exports = window[\"wp\"][\"i18n\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * External dependencies\n */\nimport { AMP_PLUGINS, AMP_COMPATIBLE } from 'amp-plugins'; // From WP inline script.\nimport { debounce } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport domReady from '@wordpress/dom-ready';\nimport { __ } from '@wordpress/i18n';\n\nconst ampPluginInstall = {\n\n\t/**\n\t * Init function.\n\t */\n\tinit() {\n\t\tif ( this.isAmpCompatibleTab() ) {\n\t\t\tthis.removeAdditionalInfo();\n\t\t} else {\n\t\t\tthis.addAmpMessage();\n\t\t}\n\t\tthis.addAmpMessageInSearchResult();\n\t},\n\n\t/**\n\t * Check if \"AMP Compatible\" tab is open or not.\n\t *\n\t * @return {boolean} Is AMP-compatible tab.\n\t */\n\tisAmpCompatibleTab() {\n\t\tconst queryParams = new URLSearchParams( window.location.search.substr( 1 ) );\n\t\treturn queryParams.get( 'tab' ) === AMP_COMPATIBLE;\n\t},\n\n\t/**\n\t * Add message for AMP Compatibility in AMP-compatible plugins card after search result comes in.\n\t */\n\taddAmpMessageInSearchResult() {\n\t\tconst pluginFilterForm = document.getElementById( 'plugin-filter' );\n\t\tconst pluginInstallSearch = document.querySelector( '.plugin-install-php .wp-filter-search' );\n\t\tif ( ! pluginFilterForm || ! pluginInstallSearch ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst startSearchResults = debounce( () => {\n\t\t\tpluginInstallSearch.removeEventListener( 'input', startSearchResults, { once: true } ); // For IE 11 which doesn't support once events.\n\n\t\t\t// Replace the class for our custom AMP-compatible tab once doing a search.\n\t\t\tconst wrap = document.querySelector( '.plugin-install-tab-amp-compatible' );\n\t\t\tif ( wrap ) {\n\t\t\t\twrap.classList.remove( 'plugin-install-tab-amp-compatible' );\n\t\t\t\twrap.classList.add( 'plugin-install-tab-search-result' );\n\t\t\t}\n\n\t\t\t// Start watching for changes the first time a search is being made.\n\t\t\tconst mutationObserver = new MutationObserver( () => {\n\t\t\t\tthis.addAmpMessage();\n\t\t\t} );\n\t\t\tmutationObserver.observe( pluginFilterForm, { childList: true } );\n\t\t}, 1000 ); // See timeout in core: <https://github.com/WordPress/WordPress/blob/b87617e2719d114d123a88ed7e489170f0204735/wp-admin/js/updates.js#L2578>\n\n\t\tpluginInstallSearch.addEventListener( 'input', startSearchResults, { once: true } );\n\t},\n\n\t/**\n\t * Add message for AMP Compatibility in AMP-compatible plugins card.\n\t */\n\taddAmpMessage() {\n\t\tfor ( const pluginSlug of AMP_PLUGINS ) {\n\t\t\tconst pluginCardElement = document.querySelector( `.plugin-card.plugin-card-${ pluginSlug }` );\n\n\t\t\tif ( ! pluginCardElement ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Skip cards that have already been processed.\n\t\t\tif ( pluginCardElement.classList.contains( 'amp-extension-card-message' ) ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst messageElement = document.createElement( 'div' );\n\t\t\tconst iconElement = document.createElement( 'span' );\n\t\t\tconst tooltipElement = document.createElement( 'span' );\n\n\t\t\tmessageElement.classList.add( 'amp-extension-card-message' );\n\t\t\ticonElement.classList.add( 'amp-logo-icon' );\n\t\t\ttooltipElement.classList.add( 'tooltiptext' );\n\n\t\t\ttooltipElement.append(\n\t\t\t\t__( 'This is known to work well with the AMP plugin.', 'amp' ),\n\t\t\t);\n\n\t\t\tmessageElement.append( iconElement );\n\t\t\tmessageElement.append( tooltipElement );\n\n\t\t\tpluginCardElement.appendChild( messageElement );\n\t\t}\n\t},\n\n\t/**\n\t * Remove the additional info from the plugin card in the \"AMP Compatible\" tab.\n\t */\n\tremoveAdditionalInfo() {\n\t\tconst pluginCardBottom = document.querySelectorAll( '.plugin-install-tab-amp-compatible .plugin-card-bottom' );\n\t\tfor ( const elementNode of pluginCardBottom ) {\n\t\t\telementNode.remove();\n\t\t}\n\t},\n};\n\ndomReady( () => {\n\tampPluginInstall.init();\n} );\n"],"names":["AMP_PLUGINS","AMP_COMPATIBLE","debounce","domReady","__","ampPluginInstall","init","isAmpCompatibleTab","removeAdditionalInfo","addAmpMessage","addAmpMessageInSearchResult","queryParams","URLSearchParams","window","location","search","substr","get","pluginFilterForm","document","getElementById","pluginInstallSearch","querySelector","startSearchResults","removeEventListener","once","wrap","classList","remove","add","mutationObserver","MutationObserver","observe","childList","addEventListener","pluginSlug","pluginCardElement","contains","messageElement","createElement","iconElement","tooltipElement","append","appendChild","pluginCardBottom","querySelectorAll","elementNode"],"sourceRoot":""}