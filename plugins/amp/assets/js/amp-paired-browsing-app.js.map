{"version":3,"file":"amp-paired-browsing-app.js","mappings":";;;;;;;;;;;AAAA;;;;;;;;;;;ACAA;;;;;;;;;;;;;;ACAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;;AAEA;AACA;;;;;;UCbA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA,eAAe,4BAA4B;WAC3C,eAAe;WACf,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC;;;;;WCPD,8CAA8C;;;;;WCA9C;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA;AAEA;AACA;AACA;;AACA;AAEA,MAAM;AAAEE,EAAAA,wBAAF;AAA4BC,EAAAA;AAA5B,IAAwCC,MAA9C;AACA,MAAM;AACLC,EAAAA,aADK;AAELC,EAAAA,WAFK;AAGLC,EAAAA,yBAHK;AAILC,EAAAA;AAJK,IAKFN,wBALJ;;AAOA,MAAMO,iBAAN,CAAwB;AACvB;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACA;AACA;;AAGC;AACD;AACA;AACCC,EAAAA,WAAW,GAAG;AAAA;;AAAA;;AAAA,qHAlFUC,IAAI,CAACC,GAAL,EAkFV;;AAAA;;AAAA,wHApEa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","sources":["webpack://amp-wp/./assets/src/admin/paired-browsing/app.css?23d0","webpack://amp-wp/external window [\"wp\",\"url\"]","webpack://amp-wp/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://amp-wp/webpack/bootstrap","webpack://amp-wp/webpack/runtime/compat get default export","webpack://amp-wp/webpack/runtime/define property getters","webpack://amp-wp/webpack/runtime/global","webpack://amp-wp/webpack/runtime/hasOwnProperty shorthand","webpack://amp-wp/webpack/runtime/make namespace object","webpack://amp-wp/./assets/src/admin/paired-browsing/app.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"wp\"][\"url\"];","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport { addQueryArgs, removeQueryArgs } from '@wordpress/url';\n\n/**\n * Internal dependencies\n */\nimport './app.css';\n\nconst { ampPairedBrowsingAppData, history } = window;\nconst {\n\tnoampQueryVar,\n\tnoampMobile,\n\tampPairedBrowsingQueryVar,\n\tdocumentTitlePrefix,\n} = ampPairedBrowsingAppData;\n\nclass PairedBrowsingApp {\n\t/**\n\t * Disconnected client.\n\t *\n\t * @type {HTMLIFrameElement}\n\t */\n\tdisconnectedClient;\n\n\t/**\n\t * AMP IFrame\n\t *\n\t * @type {HTMLIFrameElement}\n\t */\n\tampIframe;\n\n\t/**\n\t * Timestamp when the AMP iframe last sent a heartbeat.\n\t *\n\t * @type {number}\n\t */\n\tampHeartbeatTimestamp = Date.now();\n\n\t/**\n\t * Non-AMP IFrame\n\t *\n\t * @type {HTMLIFrameElement}\n\t */\n\tnonAmpIframe;\n\n\t/**\n\t * Timestamp when the non-AMP iframe last sent a heartbeat.\n\t *\n\t * @type {number}\n\t */\n\tnonAmpHeartbeatTimestamp = Date.now();\n\n\t/**\n\t * Current AMP URL.\n\t *\n\t * @type {string}\n\t */\n\tcurrentAmpUrl;\n\n\t/**\n\t * Initial URL object for the AMP URL.\n\t *\n\t * @type {URL}\n\t */\n\tinitialAmpUrlObject;\n\n\t/**\n\t * The most recent URL that was being navigated to in the AMP window.\n\t *\n\t * @type {?string}\n\t */\n\tnavigateAmpUrl;\n\n\t/**\n\t * Current non-AMP URL.\n\t *\n\t * @type {string}\n\t */\n\tcurrentNonAmpUrl;\n\n\t/**\n\t * Initial URL object for the non-AMP URL.\n\t *\n\t * @type {URL}\n\t */\n\tinitialNonAmpUrlObject;\n\n\t/**\n\t * The most recent URL that was being navigated to in the non-AMP window.\n\t *\n\t * @type {?string}\n\t */\n\tnavigateNonAmpUrl;\n\n\t/**\n\t * Non-AMP Link\n\t *\n\t * @type {HTMLAnchorElement}\n\t */\n\tnonAmpLink;\n\n\t/**\n\t * AMP Link\n\t *\n\t * @type {HTMLAnchorElement}\n\t */\n\tampLink;\n\n\t/**\n\t * Active iframe.\n\t *\n\t * @type {?HTMLIFrameElement}\n\t */\n\tactiveIframe;\n\n\t/**\n\t * Constructor.\n\t */\n\tconstructor() {\n\t\tthis.nonAmpIframe = document.querySelector( '#non-amp iframe' );\n\t\tthis.ampIframe = document.querySelector( '#amp iframe' );\n\n\t\tthis.currentNonAmpUrl = this.nonAmpIframe.src;\n\t\tthis.initialNonAmpUrlObject = new URL( this.currentNonAmpUrl );\n\t\tthis.currentAmpUrl = this.ampIframe.src;\n\t\tthis.initialAmpUrlObject = new URL( this.currentNonAmpUrl );\n\n\t\t// Link to exit paired browsing.\n\t\tthis.nonAmpLink = /** @type {HTMLAnchorElement} */ document.getElementById( 'non-amp-link' );\n\t\tthis.ampLink = /** @type {HTMLAnchorElement} */ document.getElementById( 'amp-link' );\n\n\t\t// Overlay that is displayed on the client that becomes disconnected.\n\t\tthis.disconnectOverlay = document.querySelector( '.disconnect-overlay' );\n\t\tthis.disconnectButtons = {\n\t\t\texit: document.querySelector( '.disconnect-overlay .button.exit' ),\n\t\t\tgoBack: document.querySelector( '.disconnect-overlay .button.go-back' ),\n\t\t};\n\t\tthis.addDisconnectButtonListeners();\n\n\t\tglobal.addEventListener( 'message', ( event ) => {\n\t\t\tthis.receiveMessage( event );\n\t\t} );\n\n\t\t// Set the active iframe based on which got the last mouseenter.\n\t\t// Note that setting activeIframe may get set by receiveScroll if the user starts scrolling\n\t\t// before moving the mouse.\n\t\tdocument.getElementById( 'non-amp' ).addEventListener( 'mouseenter', () => {\n\t\t\tthis.activeIframe = this.nonAmpIframe;\n\t\t} );\n\t\tdocument.getElementById( 'amp' ).addEventListener( 'mouseenter', () => {\n\t\t\tthis.activeIframe = this.ampIframe;\n\t\t} );\n\n\t\t// Load clients.\n\t\tPromise.all( this.getIframeLoadedPromises() ).then( () => {\n\t\t\tsetInterval(\n\t\t\t\t() => {\n\t\t\t\t\tthis.checkConnectedClients();\n\t\t\t\t},\n\t\t\t\t100,\n\t\t\t);\n\t\t} );\n\t}\n\n\t/**\n\t * Return whether the window is for the AMP page.\n\t *\n\t * @param {Window} win Window.\n\t * @return {boolean} Whether AMP window.\n\t */\n\tisAmpWindow( win ) {\n\t\treturn win === this.ampIframe.contentWindow;\n\t}\n\n\t/**\n\t * Return whether the window is for the non-AMP page.\n\t *\n\t * @param {Window} win Window.\n\t * @return {boolean} Whether non-AMP window.\n\t */\n\tisNonAmpWindow( win ) {\n\t\treturn win === this.nonAmpIframe.contentWindow;\n\t}\n\n\t/**\n\t * Send message to app.\n\t *\n\t * @param {Window} win  Window.\n\t * @param {string} type Type.\n\t * @param {Object} data Data.\n\t */\n\tsendMessage( win, type, data = {} ) {\n\t\twin.postMessage(\n\t\t\t{\n\t\t\t\ttype,\n\t\t\t\t...data,\n\t\t\t\tampPairedBrowsing: true,\n\t\t\t},\n\t\t\tthis.isAmpWindow( win ) ? this.currentAmpUrl : this.currentNonAmpUrl,\n\t\t);\n\t}\n\n\t/**\n\t * Receive message.\n\t *\n\t * @param {MessageEvent} event\n\t */\n\treceiveMessage( event ) {\n\t\tif ( ! event.data || ! event.data.type || ! event.data.ampPairedBrowsing || ! event.source ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! [ this.initialNonAmpUrlObject.origin, this.initialAmpUrlObject.origin ].includes( event.origin ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( ! this.isAmpWindow( event.source ) && ! this.isNonAmpWindow( event.source ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch ( event.data.type ) {\n\t\t\tcase 'loaded':\n\t\t\t\tthis.receiveLoaded( event.data, event.source );\n\t\t\t\tbreak;\n\t\t\tcase 'scroll':\n\t\t\t\tthis.receiveScroll( event.data, event.source );\n\t\t\t\tbreak;\n\t\t\tcase 'heartbeat':\n\t\t\t\tthis.receiveHeartbeat( event.source );\n\t\t\t\tbreak;\n\t\t\tcase 'navigate':\n\t\t\t\tthis.receiveNavigate( event.data, event.source );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t}\n\t}\n\n\t/**\n\t * Return promises to load iframes asynchronously.\n\t *\n\t * @return {Promise<void>[]} Promises that determine if the iframes are loaded.\n\t */\n\tgetIframeLoadedPromises() {\n\t\treturn [\n\t\t\tnew Promise( ( resolve ) => {\n\t\t\t\tthis.nonAmpIframe.addEventListener( 'load', resolve );\n\t\t\t} ),\n\t\t\tnew Promise( ( resolve ) => {\n\t\t\t\tthis.ampIframe.addEventListener( 'load', resolve );\n\t\t\t} ),\n\t\t];\n\t}\n\n\t/**\n\t * Receive heartbeat.\n\t *\n\t * @param {Window} sourceWindow The source window.\n\t */\n\treceiveHeartbeat( sourceWindow ) {\n\t\tif ( this.isAmpWindow( sourceWindow ) ) {\n\t\t\tthis.ampHeartbeatTimestamp = Date.now();\n\t\t} else {\n\t\t\tthis.nonAmpHeartbeatTimestamp = Date.now();\n\t\t}\n\t}\n\n\t/**\n\t * Receive navigate.\n\t *\n\t * @param {Object} data         Data.\n\t * @param {string} data.href    Href.\n\t * @param {Window} sourceWindow The source window.\n\t */\n\treceiveNavigate( { href }, sourceWindow ) {\n\t\tif ( this.isAmpWindow( sourceWindow ) ) {\n\t\t\tthis.navigateAmpUrl = href;\n\t\t} else {\n\t\t\tthis.navigateNonAmpUrl = href;\n\t\t}\n\t}\n\n\t/**\n\t * Check connected clients.\n\t */\n\tcheckConnectedClients() {\n\t\tthis.sendMessage( this.ampIframe.contentWindow, 'init' );\n\t\tthis.sendMessage( this.nonAmpIframe.contentWindow, 'init' );\n\n\t\tif ( ! this.isClientConnected( this.ampIframe ) ) {\n\t\t\tthis.showDisconnectOverlay( this.ampIframe );\n\t\t} else if ( ! this.isClientConnected( this.nonAmpIframe ) ) {\n\t\t\tthis.showDisconnectOverlay( this.nonAmpIframe );\n\t\t} else {\n\t\t\tthis.disconnectOverlay.classList.remove( 'disconnected' );\n\t\t}\n\t}\n\n\t/**\n\t * Add event listeners for buttons on disconnect overlay.\n\t */\n\taddDisconnectButtonListeners() {\n\t\t// The 'Go back' button goes back to the previous page of the parent window.\n\t\tthis.disconnectButtons.goBack.addEventListener( 'click', () => {\n\t\t\twindow.history.back();\n\t\t} );\n\t}\n\n\t/**\n\t * Shows the 'disconnected' overlay for the supplied iframe.\n\t *\n\t * @param {HTMLIFrameElement} iframe The iframe that hosts the paired browsing client.\n\t */\n\tshowDisconnectOverlay( iframe ) {\n\t\t// Show the exit link if we know the URL that the user was last trying to go to.\n\t\tconst navigateUrl = this.ampIframe === iframe ? this.navigateAmpUrl : this.navigateNonAmpUrl;\n\t\tif ( navigateUrl ) {\n\t\t\tthis.disconnectButtons.exit.hidden = false;\n\t\t\tthis.disconnectButtons.exit.href = navigateUrl;\n\t\t} else {\n\t\t\tthis.disconnectButtons.exit.hidden = true;\n\t\t}\n\n\t\t// Show the 'Go Back' button if the parent window has history.\n\t\tthis.disconnectButtons.goBack.hidden = 0 >= window.history.length;\n\n\t\t// Applying the 'amp' class will overlay it on the AMP iframe.\n\t\tthis.disconnectOverlay.classList.toggle(\n\t\t\t'amp',\n\t\t\tthis.ampIframe === iframe,\n\t\t);\n\n\t\tthis.disconnectOverlay.classList.add( 'disconnected' );\n\t}\n\n\t/**\n\t * Determines the status of the paired browsing client in an iframe.\n\t *\n\t * @param {HTMLIFrameElement} iframe The iframe.\n\t * @return {boolean} Whether the client is connected.\n\t */\n\tisClientConnected( iframe ) {\n\t\tconst threshold = 2000;\n\t\tif ( iframe === this.ampIframe ) {\n\t\t\treturn Date.now() - this.ampHeartbeatTimestamp < threshold;\n\t\t}\n\t\treturn Date.now() - this.nonAmpHeartbeatTimestamp < threshold;\n\t}\n\n\t/**\n\t * Purge removable query vars from the supplied URL.\n\t *\n\t * @param {string} url URL string.\n\t * @return {string} Modified URL without any AMP related query variables.\n\t */\n\tpurgeRemovableQueryVars( url ) {\n\t\treturn removeQueryArgs( url, noampQueryVar, ampPairedBrowsingQueryVar );\n\t}\n\n\t/**\n\t * Adds the AMP paired browsing query variable to the supplied URL.\n\t *\n\t * @param {string} url URL string.\n\t * @return {string} Modified URL with the AMP paired browsing query variable.\n\t */\n\taddPairedBrowsingQueryVar( url ) {\n\t\treturn addQueryArgs(\n\t\t\turl,\n\t\t\t{\n\t\t\t\t[ ampPairedBrowsingQueryVar ]: '1',\n\t\t\t},\n\t\t);\n\t}\n\n\t/**\n\t * Removes the URL hash from the supplied URL.\n\t *\n\t * @param {string} url URL string.\n\t * @return {string} Modified URL without the hash.\n\t */\n\tremoveUrlHash( url ) {\n\t\tconst parsedUrl = new URL( url );\n\t\tparsedUrl.hash = '';\n\t\treturn parsedUrl.href;\n\t}\n\n\t/**\n\t * Replace location.\n\t *\n\t * @param {HTMLIFrameElement} iframe IFrame Element.\n\t * @param {string}            url    URL.\n\t */\n\treplaceLocation( iframe, url ) {\n\t\tthis.sendMessage(\n\t\t\tiframe.contentWindow,\n\t\t\t'replaceLocation',\n\t\t\t{ href: url },\n\t\t);\n\t}\n\n\t/**\n\t * Receive scroll.\n\t *\n\t * @param {Object} data         Data.\n\t * @param {number} data.x       X position.\n\t * @param {number} data.y       Y position.\n\t * @param {Window} sourceWindow The source window.\n\t */\n\treceiveScroll( { x, y }, sourceWindow ) {\n\t\t// Rely on scroll event to determine initially-active iframe before mouse first moves.\n\t\tif ( ! this.activeIframe ) {\n\t\t\tthis.activeIframe = this.isAmpWindow( sourceWindow )\n\t\t\t\t? this.ampIframe\n\t\t\t\t: this.nonAmpIframe;\n\t\t}\n\n\t\t// Ignore scroll events from the non-active iframe.\n\t\tif ( ! this.activeIframe || sourceWindow !== this.activeIframe.contentWindow ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst otherWindow = this.isAmpWindow( sourceWindow )\n\t\t\t? this.nonAmpIframe.contentWindow\n\t\t\t: this.ampIframe.contentWindow;\n\t\tthis.sendMessage( otherWindow, 'scroll', { x, y } );\n\t}\n\n\t/**\n\t * Receive loaded.\n\t *\n\t * @param {Object}  data               Data.\n\t * @param {boolean} data.isAmpDocument Whether the document is actually an AMP page.\n\t * @param {string}  data.ampUrl        The AMP URL.\n\t * @param {string}  data.nonAmpUrl     The non-AMP URL.\n\t * @param {string}  data.documentTitle The title of the document.\n\t * @param {Window}  sourceWindow       The source window.\n\t */\n\treceiveLoaded( { isAmpDocument, ampUrl, nonAmpUrl, documentTitle }, sourceWindow ) {\n\t\tconst isAmpSource = this.isAmpWindow( sourceWindow );\n\t\tconst sourceIframe = isAmpSource ? this.ampIframe : this.nonAmpIframe;\n\n\t\tif ( isAmpSource ) {\n\t\t\t// Force the AMP iframe to always have an AMP URL.\n\t\t\tif ( ! isAmpDocument ) {\n\t\t\t\tthis.replaceLocation( sourceIframe, ampUrl );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentAmpUrl = ampUrl;\n\n\t\t\t// Update the AMP link above the iframe used for exiting paired browsing.\n\t\t\tthis.ampLink.href = removeQueryArgs( ampUrl, noampQueryVar );\n\t\t} else {\n\t\t\t// Force the non-AMP iframe to always have a non-AMP URL.\n\t\t\tif ( isAmpDocument ) {\n\t\t\t\tthis.replaceLocation( sourceIframe, nonAmpUrl );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentNonAmpUrl = nonAmpUrl;\n\n\t\t\t// Update the non-AMP link above the iframe used for exiting paired browsing.\n\t\t\tthis.nonAmpLink.href = addQueryArgs(\n\t\t\t\tnonAmpUrl,\n\t\t\t\t{ [ noampQueryVar ]: noampMobile },\n\t\t\t);\n\t\t}\n\n\t\t// Make sure the opposite iframe is set to match.\n\t\tconst thisCurrentUrl = isAmpSource ? nonAmpUrl : ampUrl;\n\t\tconst otherCurrentUrl = isAmpSource ? this.currentNonAmpUrl : this.currentAmpUrl;\n\n\t\tif (\n\t\t\tthis.purgeRemovableQueryVars( this.removeUrlHash( thisCurrentUrl ) ) !==\n\t\t\tthis.purgeRemovableQueryVars( this.removeUrlHash( otherCurrentUrl ) )\n\t\t) {\n\t\t\tconst url = isAmpSource\n\t\t\t\t? nonAmpUrl\n\t\t\t\t: ampUrl;\n\n\t\t\tthis.replaceLocation(\n\t\t\t\tisAmpSource ? this.nonAmpIframe : this.ampIframe,\n\t\t\t\tthis.purgeRemovableQueryVars( url ),\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tdocument.title = documentTitlePrefix + ' ' + documentTitle;\n\n\t\thistory.replaceState(\n\t\t\t{},\n\t\t\t'',\n\t\t\tthis.addPairedBrowsingQueryVar( this.purgeRemovableQueryVars( nonAmpUrl ) ),\n\t\t);\n\t}\n}\n\nwindow.pairedBrowsingApp = new PairedBrowsingApp();\n"],"names":["addQueryArgs","removeQueryArgs","ampPairedBrowsingAppData","history","window","noampQueryVar","noampMobile","ampPairedBrowsingQueryVar","documentTitlePrefix","PairedBrowsingApp","constructor","Date","now","nonAmpIframe","document","querySelector","ampIframe","currentNonAmpUrl","src","initialNonAmpUrlObject","URL","currentAmpUrl","initialAmpUrlObject","nonAmpLink","getElementById","ampLink","disconnectOverlay","disconnectButtons","exit","goBack","addDisconnectButtonListeners","global","addEventListener","event","receiveMessage","activeIframe","Promise","all","getIframeLoadedPromises","then","setInterval","checkConnectedClients","isAmpWindow","win","contentWindow","isNonAmpWindow","sendMessage","type","data","postMessage","ampPairedBrowsing","source","origin","includes","receiveLoaded","receiveScroll","receiveHeartbeat","receiveNavigate","resolve","sourceWindow","ampHeartbeatTimestamp","nonAmpHeartbeatTimestamp","href","navigateAmpUrl","navigateNonAmpUrl","isClientConnected","showDisconnectOverlay","classList","remove","back","iframe","navigateUrl","hidden","length","toggle","add","threshold","purgeRemovableQueryVars","url","addPairedBrowsingQueryVar","removeUrlHash","parsedUrl","hash","replaceLocation","x","y","otherWindow","isAmpDocument","ampUrl","nonAmpUrl","documentTitle","isAmpSource","sourceIframe","thisCurrentUrl","otherCurrentUrl","title","replaceState","pairedBrowsingApp"],"sourceRoot":""}