{"version":3,"file":"amp-paired-browsing-client.js","mappings":"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","sources":["webpack://amp-wp/external window [\"wp\",\"domReady\"]","webpack://amp-wp/webpack/bootstrap","webpack://amp-wp/webpack/runtime/compat get default export","webpack://amp-wp/webpack/runtime/define property getters","webpack://amp-wp/webpack/runtime/global","webpack://amp-wp/webpack/runtime/hasOwnProperty shorthand","webpack://amp-wp/webpack/runtime/make namespace object","webpack://amp-wp/./assets/src/admin/paired-browsing/client.js"],"sourcesContent":["module.exports = window[\"wp\"][\"domReady\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * WordPress dependencies\n */\nimport domReady from '@wordpress/dom-ready';\n\nconst { parent, ampPairedBrowsingClientData } = window;\nconst { ampUrl, nonAmpUrl, isAmpDocument } = ampPairedBrowsingClientData;\n\nconst nonAmpUrlObject = new URL( nonAmpUrl );\n\n/**\n * Modify document for paired browsing.\n */\nfunction modifyDocumentForPairedBrowsing() {\n\t// Scrolling is not synchronized if `scroll-behavior` is set to `smooth`.\n\tdocument.documentElement.style.setProperty( 'scroll-behavior', 'auto', 'important' );\n\n\tif ( isAmpDocument ) {\n\t\t// Hide the paired browsing menu item.\n\t\tconst pairedBrowsingMenuItem = document.getElementById( 'wp-admin-bar-amp-paired-browsing' );\n\t\tif ( pairedBrowsingMenuItem ) {\n\t\t\tpairedBrowsingMenuItem.remove();\n\t\t}\n\n\t\t// Hide menu item to view non-AMP version.\n\t\tconst ampViewBrowsingItem = document.getElementById( 'wp-admin-bar-amp-view' );\n\t\tif ( ampViewBrowsingItem ) {\n\t\t\tampViewBrowsingItem.remove();\n\t\t}\n\t} else {\n\t\t// No need to show the AMP menu in the Non-AMP window.\n\t\tconst ampMenuItem = document.getElementById( 'wp-admin-bar-amp' );\n\t\tampMenuItem.remove();\n\t}\n}\n\n/**\n * Send message to app.\n *\n * @param {Window} win  Window.\n * @param {string} type Type.\n * @param {Object} data Data.\n */\nfunction sendMessage( win, type, data = {} ) {\n\twin.postMessage(\n\t\t{\n\t\t\ttype,\n\t\t\t...data,\n\t\t\tampPairedBrowsing: true,\n\t\t},\n\t\tnonAmpUrlObject.origin, // Because the paired browsing app is accessed via the canonical URL.\n\t);\n}\n\nlet initialized = false;\n\n/**\n * Receive message.\n *\n * @param {MessageEvent} event\n */\nfunction receiveMessage( event ) {\n\tif ( ! event.data || ! event.data.ampPairedBrowsing || ! event.data.type || ! event.source || nonAmpUrlObject.origin !== event.origin ) {\n\t\treturn;\n\t}\n\tswitch ( event.data.type ) {\n\t\tcase 'init':\n\t\t\tif ( ! initialized ) {\n\t\t\t\tinitialized = true;\n\t\t\t\treceiveInit();\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'scroll':\n\t\t\treceiveScroll( event.data );\n\t\t\tbreak;\n\t\tcase 'replaceLocation':\n\t\t\treceiveReplaceLocation( event.data );\n\t\t\tbreak;\n\t\tdefault:\n\t}\n}\n\n/**\n * Send scroll.\n */\nfunction sendScroll() {\n\tsendMessage(\n\t\tparent,\n\t\t'scroll',\n\t\t{\n\t\t\tx: window.scrollX,\n\t\t\ty: window.scrollY,\n\t\t},\n\t);\n}\n\n/**\n * Receive scroll.\n *\n * @param {Object} data\n * @param {number} data.x\n * @param {number} data.y\n */\nfunction receiveScroll( { x, y } ) {\n\twindow.scrollTo( x, y );\n}\n\n/**\n * Handle click event.\n *\n * @param {MouseEvent} event\n */\nfunction handleClick( event ) {\n\tconst element = event.target;\n\tconst link = element.matches( '[href]' ) ? element : element.closest( '[href]' );\n\tif ( link ) {\n\t\tsendMessage(\n\t\t\tparent,\n\t\t\t'navigate',\n\t\t\t{ href: link.href },\n\t\t);\n\t}\n}\n\n/**\n * Receive replace location.\n *\n * @param {string} href\n */\nfunction receiveReplaceLocation( { href } ) {\n\twindow.location.replace( href );\n}\n\n/**\n * Send loaded.\n */\nfunction sendLoaded() {\n\tsendMessage(\n\t\tparent,\n\t\t'loaded',\n\t\t{\n\t\t\tisAmpDocument,\n\t\t\tampUrl,\n\t\t\tnonAmpUrl,\n\t\t\tdocumentTitle: document.title,\n\t\t},\n\t);\n}\n\n/**\n * Send heartbeat.\n */\nfunction sendHeartbeat() {\n\tsendMessage( parent, 'heartbeat' );\n}\n\n/**\n * Receive init.\n */\nfunction receiveInit() {\n\tsendHeartbeat();\n\tsetInterval( sendHeartbeat, 500 );\n\n\tglobal.document.addEventListener( 'click', handleClick, { passive: true } );\n\tglobal.addEventListener( 'scroll', sendScroll, { passive: true } );\n\tdomReady( modifyDocumentForPairedBrowsing );\n\n\tsendLoaded();\n}\n\nglobal.addEventListener( 'message', receiveMessage );\n"],"names":["domReady","parent","ampPairedBrowsingClientData","window","ampUrl","nonAmpUrl","isAmpDocument","nonAmpUrlObject","URL","modifyDocumentForPairedBrowsing","document","documentElement","style","setProperty","pairedBrowsingMenuItem","getElementById","remove","ampViewBrowsingItem","ampMenuItem","sendMessage","win","type","data","postMessage","ampPairedBrowsing","origin","initialized","receiveMessage","event","source","receiveInit","receiveScroll","receiveReplaceLocation","sendScroll","x","scrollX","y","scrollY","scrollTo","handleClick","element","target","link","matches","closest","href","location","replace","sendLoaded","documentTitle","title","sendHeartbeat","setInterval","global","addEventListener","passive"],"sourceRoot":""}